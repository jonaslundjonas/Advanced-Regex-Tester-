<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Regex Tester (Offline)</title>
    
    <style>
        :root {
            /* Material Design 3 - Dark Theme Palette */
            --md-color-primary: #a7c8ff;
            --md-color-on-primary: #00315a;
            --md-color-surface-container: #1e2025;
            --md-color-surface: #101216;
            --md-color-on-surface: #e2e2e7;
            --md-color-on-surface-variant: #c3c6cf;
            --md-color-outline: #8d9199;
            --md-color-error: #ffb4ab;
            --md-textfield-bg: #2b2e33;
            --md-textfield-border-color: #8d9199;
            
            /* Highlight Colors */
            --highlight-bg: hsla(212, 100%, 76%, 0.4); /* Primary color with alpha */
            --highlight-border: #a7c8ff;
            
            /* Shared styles for textarea and highlight overlay */
            --editor-font: 'Courier New', Courier, monospace;
            --editor-font-size: 1rem;
            --editor-line-height: 1.6;
            --editor-padding: 28px 16px 8px 16px;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--md-color-surface-container);
            color: var(--md-color-on-surface);
            margin: 0;
            padding: 24px;
        }

        .container {
            max-width: 1400px; /* Wider layout for more tools */
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 900px) {
            .main-grid {
                grid-template-columns: 1fr; /* Stack columns on mobile */
            }
        }

        .input-column, .output-column {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        h1 {
            color: var(--md-color-primary);
            text-align: center;
            font-weight: 500;
            margin-top: 0;
            margin-bottom: 8px;
        }
        
        h2 {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--md-color-on-surface-variant);
            margin: 0;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--md-textfield-bg);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }
        
        /* Base button style */
        .btn {
            background: none;
            border: 1px solid var(--md-color-outline);
            color: var(--md-color-primary);
            border-radius: 20px;
            padding: 4px 12px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .btn:hover {
            background-color: var(--md-color-primary);
            color: var(--md-color-on-primary);
        }
        
        /* Copy button specific style */
        .copy-btn {
             /* Inherits from .btn */
        }
        .copy-btn.copied {
            background-color: #4caf50;
            border-color: #4caf50;
            color: white;
        }

        /* Clear Button Styles */
        .button-group {
            display: flex;
            gap: 8px; /* Space between buttons */
        }
        .btn-secondary {
            background-color: transparent;
            color: var(--md-color-outline);
            border-color: var(--md-color-outline);
        }
        .btn-secondary:hover {
            background-color: var(--md-textfield-bg);
            color: var(--md-color-primary);
            border-color: var(--md-color-primary);
        }
        
        /* --- File Uploader and Scan Button --- */
        .btn-primary {
            background-color: var(--md-color-primary);
            color: var(--md-color-on-primary);
            font-weight: bold;
            font-size: 0.9rem;
            padding: 10px 16px;
        }
        .btn-primary:hover {
            background-color: #cbe1ff;
        }
        .btn-primary:disabled {
            background-color: var(--md-textfield-bg);
            color: var(--md-color-outline);
            border-color: var(--md-textfield-bg);
            cursor: not-allowed;
        }
        
        .file-scanner {
            background-color: var(--md-color-surface);
            border-radius: 8px;
            border: 1px solid var(--md-color-outline);
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        input[type="file"] {
            color: var(--md-color-on-surface-variant);
            font-family: inherit;
        }
        
        /* Custom file input button */
        input[type="file"]::file-selector-button {
            background-color: var(--md-textfield-bg);
            border: 1px solid var(--md-color-outline);
            color: var(--md-color-primary);
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-right: 12px;
        }
        input[type="file"]::file-selector-button:hover {
            background-color: var(--md-color-primary);
            color: var(--md-color-on-primary);
        }
        
        #scan-status {
            font-size: 0.9rem;
            color: var(--md-color-on-surface-variant);
            min-height: 1.2em;
        }


        /* --- Material Design Text Field Emulation --- */
        .md-textfield {
            position: relative;
            background-color: var(--md-textfield-bg);
            border-radius: 8px 8px 0 0;
            border-bottom: 1px solid var(--md-textfield-border-color);
        }
        .md-textfield label {
            position: absolute;
            top: 18px;
            left: 16px;
            color: var(--md-color-on-surface-variant);
            font-size: 1rem;
            pointer-events: none;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .md-textfield textarea {
            width: 100%;
            box-sizing: border-box;
            padding: var(--editor-padding);
            border: none;
            background-color: transparent;
            font-family: inherit;
            color: var(--md-color-on-surface);
            resize: vertical;
        }
        .md-textfield textarea:focus {
            outline: none;
            border-bottom: 2px solid var(--md-color-primary);
            margin-bottom: -1px; /* Account for thicker border */
        }
        .md-textfield textarea:focus + label,
        .md-textfield textarea:not(:placeholder-shown) + label {
            top: 6px;
            font-size: 0.75rem;
            color: var(--md-color-primary);
        }
        
        /* Specific for Regex Input */
        #regex-input {
            font-family: var(--editor-font);
            font-size: var(--editor-font-size);
            font-weight: bold;
            color: var(--md-color-primary);
            line-height: var(--editor-line-height);
        }
        
        /* --- Flag Toggles --- */
        .flag-toggles {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            padding: 12px 0;
        }
        .flag-toggle {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            user-select: none;
        }
        .flag-toggle input {
            cursor: pointer;
        }

        /* --- Pattern Library --- */
        .md-select-wrapper {
            position: relative;
            background-color: var(--md-textfield-bg);
            border-radius: 8px 8px 0 0;
            border-bottom: 1px solid var(--md-textfield-border-color);
        }
        .md-select-wrapper label {
            position: absolute;
            top: 6px;
            left: 16px;
            font-size: 0.75rem;
            color: var(--md-color-primary);
        }
        .md-select-wrapper select {
            width: 100%;
            padding: 28px 16px 8px 16px;
            border: none;
            background-color: transparent;
            color: var(--md-color-on-surface);
            font-size: 1rem;
            cursor: pointer;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        .md-select-wrapper::after { /* Dropdown arrow */
            content: '▼';
            position: absolute;
            top: 50%;
            right: 16px;
            transform: translateY(-40%);
            font-size: 0.8rem;
            color: var(--md-color-on-surface-variant);
            pointer-events: none;
        }
        .md-select-wrapper select:focus {
            outline: none;
            border-bottom: 2px solid var(--md-color-primary);
            margin-bottom: -1px;
        }
        
        /* Dark Dropdown Options */
        .md-select-wrapper select option {
            background-color: var(--md-textfield-bg);
            color: var(--md-color-on-surface);
        }
        .md-select-wrapper select optgroup {
            font-style: italic;
            font-weight: bold;
            color: var(--md-color-primary);
            background-color: var(--md-color-surface-container);
        }
        
        /* --- Live Highlight Text Editor --- */
        .text-input-wrapper {
            position: relative;
            background-color: var(--md-textfield-bg);
            border-radius: 8px 8px 0 0;
            border-bottom: 1px solid var(--md-textfield-border-color);
        }
        .text-input-wrapper label {
            position: absolute;
            top: 6px;
            left: 16px;
            font-size: 0.75rem;
            color: var(--md-color-primary);
            z-index: 3;
            pointer-events: none;
        }
        
        /* Base styles for both textarea and highlight div */
        .editor-base {
            margin: 0;
            padding: var(--editor-padding);
            width: 100%;
            box-sizing: border-box;
            border: none;
            background-color: transparent;
            font-family: var(--editor-font);
            font-size: var(--editor-font-size);
            line-height: var(--editor-line-height);
            white-space: pre-wrap;
            word-wrap: break-word;
            min-height: 250px;
            resize: vertical;
        }
        
        #text-input {
            position: relative;
            z-index: 2;
            color: transparent; /* Text is invisible, caret is not */
            caret-color: var(--md-color-on-surface);
        }
        #text-input:focus {
            outline: none;
        }

        #highlight-output {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
            pointer-events: none;
            color: var(--md-color-on-surface);
            overflow: hidden; /* Scroll is handled by JS */
            resize: none;
        }
        
        /* Highlight style */
        #highlight-output mark {
            background-color: var(--highlight-bg);
            border-bottom: 2px solid var(--highlight-border);
            color: inherit;
            border-radius: 2px;
        }
        
        /* Error Message */
        #error-message {
            color: var(--md-color-error);
            font-weight: 500;
            font-family: var(--editor-font);
            font-size: 0.9rem;
            min-height: 1.2em;
            margin-top: -16px; 
            padding-left: 16px;
        }

        /* --- Output Groups --- */
        .output-group {
            background-color: var(--md-color-surface);
            border-radius: 8px;
            border: 1px solid var(--md-color-outline);
            padding: 16px;
        }
        .output-box {
            background-color: #1a1e22;
            border: 1px solid #3d4146;
            border-radius: 4px;
            padding: 16px;
            min-height: 150px;
            font-family: var(--editor-font);
            font-size: 0.95rem;
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.5;
            color: #d8d8d8;
        }

        /* --- Cheat Sheet --- */
        details {
            border: 1px solid var(--md-color-outline);
            border-radius: 8px;
            background-color: var(--md-color-surface);
        }
        details summary {
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            padding: 14px;
            color: var(--md-color-primary);
        }
        .cheatsheet-content {
            padding: 0 16px 16px 16px;
        }
        .cheatsheet-content table {
            width: 100%;
            border-collapse: collapse;
        }
        .cheatsheet-content th, .cheatsheet-content td {
            border: 1px solid var(--md-color-outline);
            padding: 8px;
            text-align: left;
        }
        .cheatsheet-content th {
            background-color: var(--md-textfield-bg);
        }
        .cheatsheet-content code {
            background: var(--md-textfield-bg);
            padding: 2px 5px;
            border-radius: 4px;
            font-family: var(--editor-font);
            color: var(--md-color-primary);
        }
        
        .footer-credit {
            text-align: center;
            font-size: 0.9rem;
            color: var(--md-color-on-surface-variant);
            margin-top: 16px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Advanced Regex Tester</h1>
        
        <div class="main-grid">
            
            <div class="input-column">
                
                <div class="regex-group">
                    <div class="section-header">
                        <h2>Regular Expression</h2>
                        <div class="button-group">
                            <button class="btn copy-btn" id="copy-regex-btn" data-target="regex-input">Copy</button>
                            <button class="btn btn-secondary clear-btn" id="clear-regex-btn" data-target="regex-input">Clear</button>
                        </div>
                    </div>
                    <div class="md-textfield">
                        <textarea id="regex-input" placeholder=" " rows="2"></textarea>
                        <label for="regex-input">Pattern</label>
                    </div>
                    <div id="error-message"></div>
                </div>

                <div class="flag-toggles">
                    <label class="flag-toggle"><input type="checkbox" id="flag-g" value="g"> Global (g)</label>
                    <label class="flag-toggle"><input type="checkbox" id="flag-i" value="i"> Case-Insensitive (i)</label>
                    <label class="flag-toggle"><input type="checkbox" id="flag-m" value="m"> Multiline (m)</label>
                    <label class="flag-toggle"><input type="checkbox" id="flag-s" value="s"> dotAll (s)</label>
                    <label class="flag-toggle"><input type="checkbox" id="flag-u" value="u"> Unicode (u)</label>
                    <label class="flag-toggle"><input type="checkbox" id="flag-y" value="y"> Sticky (y)</label>
                </div>
                
                <div class="md-select-wrapper">
                    <label for="pattern-library">Load Snippet</label>
                    <select id="pattern-library">
                        <option value="">Select a common pattern...</option>
                        
                        <optgroup label="General">
                            <option data-pattern="\b[\w-\.]+@([\w-]+\.)+[\w-]{2,4}\b" data-flags="g,i">Email Address</option>
                            <option data-pattern="^#?([a-f0-9]{6}|[a-f0-9]{3})$" data-flags="g,i,m">Hex Color Code</option>
                        </optgroup>

                        <optgroup label="Web & Network">
                             <option data-pattern="https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)" data-flags="g,i">URL (HTTP/S)</option>
                            <option data-pattern="https?:\/\/(?:www\.)?([a-zA-Z0-9.-]+\.[a-zA-Z]{2,})" data-flags="g,i">Extract Domain Name</option>
                            <option data-pattern="^[a-z0-9]+(?:-[a-z0-9]+)*$" data-flags="g">URL Slug</option>
                            <option data-pattern="^(?:([01]?[0-9]?[0-9]|25[0-5]|2[0-4][0-9])\.){3}([01]?[0-9]?[0-9]|25[0-5]|2[0-4][0-9])$" data-flags="g,m">IP Address (IPv4)</option>
                             <option data-pattern="\b(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}\b|\b(?:[0-9a-fA-F]{1,4}:){1,7}:|\b(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}\b|\b(?:[0-9a-fA-F]{1,4}:){1,5}(?::[0-9a-fA-F]{1,4}){1,2}\b|\b(?:[0-9a-fA-F]{1,4}:){1,4}(?::[0-9a-fA-F]{1,4}){1,3}\b|\b(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}\b|\b(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}\b|\b[0-9a-fA-F]{1,4}:(?::[0-9a-fA-F]{1,4}){1,6}\b|\b:(?::[0-9a-fA-F]{1,4}){1,7}\b|::\b" data-flags="g,i">IP Address (IPv6)</option>
                            <option data-pattern="^(?:[0-9A-Fa-f]{2}([:-]?)[0-9A-Fa-f]{2})(?:(?:\1|\.)(?:[0-9A-Fa-f]{2}([:-]?)[0-9A-Fa-f]{2})){2}$" data-flags="g,i,m">MAC Address</option>
                            <option data-pattern="" data-flags="gs">HTML Comment</option>
                             <option data-pattern="<\/?[a-zA-Z0-9]+[^>]*>" data-flags="g">HTML/XML Tag</option>
                        </optgroup>
                        
                        <optgroup label="Date, Time & Misc">
                            <option data-pattern="^\d{4}-\d{2}-\d{2}$" data-flags="g,m">Date (YYYY-MM-DD)</option>
                            <option data-pattern="\b(0[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01])\/(19|20)\d{2}\b" data-flags="g">Date (MM/DD/YYYY)</option>
                            <option data-pattern="\b([01]\d|2[0-3]):([0-5]\d)(?::([0-5]\d))?\b" data-flags="g">Time (HH:MM or HH:MM:SS)</option>
                            <option data-pattern="\+(?:[0-9] ?){6,14}[0-9]" data-flags="g">International Phone (General)</option>
                            <option data-pattern="\b(?:97[89][ -]?)?\d{1,5}[ -]?\d+[- ]?\d+[- ]?[\dX]\b" data-flags="g">ISBN (10 or 13)</option>
                        </optgroup>

                        <optgroup label="Developer / Tech">
                            <option data-pattern="\b[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}\b" data-flags="g,i">UUID / GUID</option>
                            <option data-pattern="\b(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-[\w.-]+)?(?:\+[\w.-]+)?\b" data-flags="g">Semantic Version (SemVer)</option>
                            <option data-pattern="\b[\w.-]+\.[\w]{2,4}\b" data-flags="g">File with Extension</option>
                             <option data-pattern="^(?:"(?:[^"]|"")*"|[^,"]*)(?:,(?:"(?:[^"]|"")*"|[^,"]*))*$" data-flags="gm">CSV Line</option>
                        </optgroup>

                        <optgroup label="Text Processing / Validation">
                             <option data-pattern="^[a-zA-Z0-9_-]{3,16}$" data-flags="m">Username (Simple)</option>
                            <option data-pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$" data-flags="m">Password Strength (Example)</option>
                            <option data-pattern="\bword\b" data-flags="g">Match Whole Word Only (edit 'word')</option>
                            <option data-pattern="2 girls 1 cup|2g1c|4r5e|5h1t|5hit|5ht|666|@$$|a s s|a s shole|a55|a55hole|a_s_s|abbo|abeed|abuse|acrotomophilia|addicts|aeolus|africoon|ahole|alabama hot pocket|alaskan pipeline|alligator bait|alligatorbait|amcik|anal|analannie|analprobe|analsex|andskota|anilingus|anus|apeshit|ar5e|arabush|arabushs|areola|areole|argie|arian|armo|armos|aroused|arrse|arschloch|arse|arsehole|aryan|ash0le|ash0les|asholes|ass monkey|ass|ass-fucker|ass-hat|ass-pirate|assbag|assbagger|assbandit|assbang|assbanged|assbanger|assbangs|assbite|assblaster|assclown|asscock|asscowboy|asscracker|asses|assface|assfuck|assfucker|assfukka|assgoblin|assh0le|assh0lez|asshat|asshead|assho1e|asshole|assholes|assholz|asshopper|asshore|assjacker|assjockey|asskiss|asskisser|assklown|asslick|asslicker|asslover|assman|assmaster|assmonkey|assmunch|assmuncher|assnigger|asspacker|asspirate|asspuppies|assrammer|assranger|assshit|assshole|asssucker|asswad|asswhole|asswhore|asswipe|asswipes|auto erotic|autoerotic|ayir|azazel|azz|azzhole|b a s t a r d|b i t c h|b o o b|b!+ch|b!tch|b!tchin|b*tch|b00b|b00bies|b00biez|b00bs|b00bz|b17ch|b1tch|b7ch|babeland|babes|baby batter|baby juice|backdoor|backdoorman|badfuck|bagging|ball gag|ball gravy|ball kicking|ball licking|ball sack|ball sucking|ballbag|balllicker|ballsack|bampot|bangbro|bangbros|banger|banging|bareback|barely legal|barelylegal|barenaked|barf|barface|barfface|bassterd|bassterds|bastard|bastardo|bastards|bastardz|basterds|basterdz|bastinado|bawdy|bazongas|bazooms|bbw|bdsm|beaner|beaners|beaney|beaneys|beardedclam|beastality|beastial|beastiality|beastility|beatch|beatoff|beatyourmeat|beaver cleaver|beaver lips|beaver|beeyotch|bellend|beotch|bestial|bestiality|bi curious|bi+ch|bi7ch|biatch|bicurious|big black|big breasts|big knockers|big tits|bigass|bigbastard|bigbreasts|bigbutt|bigtits|bimbo|bimbos|bint|birdlock|bitch|bitchass|bitched|bitcher|bitchers|bitches|bitchez|bitchin|bitching|bitchslap|bitchtit|bitchy|biteme|black cock|blackcock|blackman|blackout|blacks|blonde action|blonde on blonde action|blonde on blonde|bloody|blow j|blow job|blow your l|blow your load|blowjob|blowjobs|blue waffle|bluegum|bluegums|blumpkin|bo ob|bo obs|boang|boche|boches|bodily|boffing|bogan|bohunk|boink|boiolas|bollick|bollock|bollocks|bollok|bollox|bombers|bombing|bomd|bondage|boned|boner|boners|bong|boob|boobies|boobs|booby|boobz|boody|booger|bookie|boong|boonga|boongas|boongs|boonie|boonies|booobs|boooobs|booooobs|booooooobs|bootee|bootlip|bootlips|booty call|booty|bootycall|boozer|boozy|bosch|bosche|bosches|boschs|bosomy|bounty bar|bounty bars|bountybar|brea5t|breastjob|breastlover|breastman|brothel|brown showers|brunette action|btch|buceta|buddhahead|buddhaheads|buffies|bugger|buggered|buggery|bukkake|bule|bules|bullcrap|bulldike|bulldyke|bullet vibe|bullshit|bullshits|bullshitted|bullturds|bumblefuck|bumfuck|bung hole|bung|bunga|bungas|bunghole|bunny fucker|burr head|burr heads|burrhead|burrheads|butchbabes|butchdike|butchdyke|butt plug|butt-pirate|buttbang|buttcheeks|buttface|buttfuck|buttfucker|buttfuckers|butthead|butthole|buttman|buttmuch|buttmunch|buttmuncher|buttons|buttpirate|buttplug|buttstain|buttwipe|byatch|c u n t|c-0-c-k|c-o-c-k|c-u-n-t|c.0.c.k|c.o.c.k.|c.u.n.t|c0ck|c0cks|c0cksucker|c0k|cabron|caca|cacker|cahone|camel jockey|camel jockeys|camel toe|cameljockey|cameltoe|camgirl|camslut|camwhore|carpet muncher|carpetmuncher|carruth|cawk|cawks|cazzo|cervix|chav|cheese eating surrender monkey|cheese eating surrender monkies|cheeseeating surrender monkey|cheeseeating surrender monkies|cheesehead|cheeseheads|cherrypopper|chickslick|china swede|china swedes|chinaman|chinamen|chinaswede|chinaswedes|chinc|chincs|ching chong|ching chongs|chinga|chingchong|chingchongs|chink|chinks|chinky|choad|chocolate rosebuds|chode|chodes|chonkies|chonky|chonkys|chraa|christ killer|christ killers|chug|chugs|chuj|chunger|chungers|chunkies|chunkys|chute|cipa|circlejerk|cl1t|clamdigger|clamdiver|clamps|clansman|clansmen|clanswoman|clanswomen|cleveland steamer|climax|clit|clitface|clitfuck|clitoris|clitorus|clits|clitty|clogwog|clover clamps|clusterfuck|cnts|cntz|cnut|cocain|cocaine|cock|cock-head|cock-sucker|cockbite|cockblock|cockblocker|cockburger|cockcowboy|cockface|cockfight|cockfucker|cockhead|cockholster|cockknob|cockknocker|cocklicker|cocklover|cockmonkey|cockmunch|cockmuncher|cocknob|cocknose|cocknugget|cockqueen|cockrider|cocks|cockshit|cocksman|cocksmith|cocksmoker|cocksucer|cocksuck|cocksucked|cocksucker|cocksucking|cocksucks|cocksuka|cocksukka|cocktease|cocky|cohee|coital|coitus|cok|cokmuncher|coksucka|commie|condom|coochie|coochy|coolie|coolies|cooly|coon ass|coon asses|coon|coonass|coonasses|coondog|coons|cooter|coprolagnia|coprophilia|copulate|corksucker|cornhole|cowgirl|cox|cra5h|crabs|crackcocain|cracker|crackpipe|crackwhore|crap|crapola|crapper|crappy|crash|creampie|crotch|crotchjockey|crotchmonkey|crotchrot|cum|cumbubble|cumdumpster|cumfest|cumjockey|cumm|cummer|cummin|cumming|cumquat|cumqueen|cums|cumshot|cumshots|cumslut|cumstain|cumtart|cunilingus|cunillingus|cunn|cunnie|cunnilingus|cunntt|cunny|cunt|cunteyed|cuntface|cuntfuck|cuntfucker|cunthole|cunthunter|cuntlick|cuntlicker|cuntlicking|cuntrag|cunts|cuntslut|cuntsucker|cuntz|curry muncher|curry munchers|currymuncher|currymunchers|cushi|cushis|cyalis|cyberfuc|cyberfuck|cyberfucked|cyberfucker|cyberfuckers|cyberfucking|cybersex|cyberslimer|d0ng|d0uch3|d0uche|d1ck|d1ld0|d1ldo|d4mn|dago|dagos|dahmer|damm|dammit|damn|damnation|damned|damnit|darkey|darkeys|darkie|darkies|darky|date rape|daterape|datnigga|dawgie style|dawgie-style|daygo|deapthroat|deep throat|deep throating|deepaction|deepthroat|deepthroating|defecate|deggo|dego|degos|demon|dendrophilia|destroyyourpussy|deth|diaper head|diaper heads|diaperhead|diaperheads|dick pic|dick|dick-ish|dickbag|dickbeaters|dickbrain|dickdipper|dickface|dickflipper|dickforbrains|dickfuck|dickhead|dickheads|dickhole|dickish|dickjuice|dickless|dicklick|dicklicker|dickman|dickmilk|dickpic|dickripper|dicks|dicksipper|dickslap|dickwad|dickweasel|dickweed|dickwhipper|dickwod|dickzipper|diddle|dike|dild0|dild0s|dildo|dildos|dilf|diligaf|dilld0|dilld0s|dillweed|dimwit|dingle|dingleberries|dingleberry|dink|dinks|dipship|dipshit|dipstick|dirsa|dirty pillows|dirty sanchez|dix|dixiedike|dixiedyke|dlck|dog style|dog-fucker|doggie style|doggie|doggie-style|doggiestyle|doggin|dogging|doggy style|doggy-style|doggystyle|dolcett|domination|dominatricks|dominatrics|dominatrix|dommes|dong|donkey punch|donkeypunch|donkeyribber|doochbag|doodoo|doofus|dookie|doosh|dot head|dot heads|dothead|dotheads|double dong|double penetration|doubledong|doublepenetration|douch3|douche bag|douche|douche-fag|douchebag|douchebags|douchewaffle|douchey|dp action|dp|dpaction|dragqueen|dragqween|dripdick|drug|dry hump|dryhump|duche|dudette|dumass|dumb ass|dumbass|dumbasses|dumbbitch|dumbfuck|dumbshit|dummy|dumshit|dune coon|dune coons|dupa|dvda|dyefly|dyke|dykes|dziwka|earotics|easyslut|eat my ass|eat my|eatballs|eatme|eatmyass|eatpussy|ecchi|ejackulate|ejaculate|ejaculated|ejaculates|ejaculating|ejaculatings|ejaculation|ejaculations|ejakulate|ekrem|ekto|enculer|enema|enlargement|erect|erection|ero|erotic|erotism|escort|esqua|essohbee|ethical slut|evl|excrement|exkwew|explosion|extacy|extasy|f u c k e r|f u c k e|f u c k|f u k|f*ck|f-u-c-k|f.u.c.k|f4nny|f_u_c_k|facefucker|fack|faeces|faen|fag|fag1t|fagbag|faget|fagfucker|fagg|fagg1t|fagged|fagging|faggit|faggitt|faggot|faggotcock|faggs|fagit|fagot|fagots|fags|fagt|fagtard|fagz|faig|faigs|faigt|fanculo|fannybandit|fannyflaps|fannyfucker|fanyy|fartknocker|farty|fastfuck|fatah|fatass|fatfuck|fatfucker|fatso|fck|fckcum|fckd|fcuk|fcuker|fcuking|fecal|feces|feck|fecker|feg|felatio|felch|felcher|felching|fellate|fellatio|feltch|feltcher|feltching|female squirting|femalesquirtin|femalesquirting|femdom|fetish|ficken|figging|fingerbang|fingerfood|fingerfuck|fingerfucked|fingerfucker|fingerfuckers|fingerfucking|fingerfucks|fingering|fisted|fister|fistfuck|fistfucked|fistfucker|fistfuckers|fistfucking|fistfuckings|fistfucks|fisting|fisty|fitt|flamer|flange|flasher|flikker|flipping the bird|floo|floozy|flydie|flydye|foad|fok|fondle|foobar|fook|fooker|foot fetish|footaction|footfetish|footfuck|footfucker|footjob|footlicker|footstar|foreskin|forni|fornicate|fotze|foursome|fourtwenty|freakfuck|freakyfucker|freefuck|freex|frigg|frigga|frotting|fubar|fucck|fuck buttons|fuck|fuck-tard|fucka|fuckable|fuckass|fuckbag|fuckbook|fuckboy|fuckbrain|fuckbuddy|fuckbutt|fuckd|fucked|fuckedup|fucker|fuckers|fuckersucker|fuckface|fuckfest|fuckfreak|fuckfriend|fuckhead|fuckheads|fuckher|fuckhole|fuckin|fuckina|fucking|fuckingbitch|fuckings|fuckingshitmotherfucker|fuckinnuts|fuckinright|fuckit|fuckknob|fuckme|fuckmehard|fuckmonkey|fuckn|fucknugget|fucknut|fucknuts|fucknutt|fucknutz|fuckoff|fuckpig|fuckr|fucks|fuckstick|fucktard|fucktards|fuckup|fuckwad|fuckwhit|fuckwhore|fuckwit|fuckwitt|fuckyou|fudge packer|fudgepacker|fugly|fuk|fukah|fuken|fuker|fukin|fuking|fukk|fukkah|fukken|fukker|fukkin|fuks|fuktard|fuktards|fukwhit|fukwit|funeral|funfuck|fungus|futanari|futkretzn|fuuck|fux|fux0r|fvck|fvk|fxck|g-spot|g00k|gae|gai|gang bang|gangbang|gangbanged|gangbanger|gangbangs|gangsta|ganja|gator bait|gatorbait|gay sex|gayboy|gaygirl|gaylord|gaymuthafuckinwhore|gays|gaysex|gayz|geezer|geni|genital|genitals|getiton|gey|gfy|ghay|ghey|giant cock|gigolo|ginzo|ginzos|gipp|gippo|gippos|gipps|girl on top|girl on|girls gone wild|givehead|glans|glazeddonut|goatcx|goatse|gob|god dammit|god damn|god damnit|god-dam|god-damned|godam|godammit|godamn|godamnit|goddam|goddamit|goddamm|goddammit|goddamn|goddamned|goddamnes|goddamnit|goddamnmuthafucker|gokkun|golden shower|goldenshower|golliwog|golliwogs|gonad|gonads|gonorrehea|gonzagas|goo girl|gooch|goodpoop|gook eye|gook eyes|gook|gookeye|gookeyes|gookies|gooks|gooky|gora|goras|goregasm|gotohell|goy|goyim|greaseball|greaseballs|gringo|gringos|groe|groid|groids|grope|gross|grostulation|group sex|gspot|gstring|gtfo|gub|gubba|gubbas|gubs|guido|guiena|guineas|guizi|gummer|guro|gwailo|gwailos|gweilo|gweilos|gyopo|gyopos|gyp|gyped|gypo|gypos|gypp|gypped|gyppie|gyppies|gyppo|gyppos|gyppy|gyppys|gypsys|h e l l|h o m|h00r|h0ar|h0m0|h0mo|h0r|h0re|h4x0r|hadji|hadjis|hairyback|hairybacks|haji|hajis|hajji|hajjis|half breed|half caste|halfbreed|halfcaste|hamas|hand job|handjob|haole|haoles|hapa|hard core|hardcore|hardcoresex|hardon|harem|he11|headfuck|hebe|hebes|heeb|heebs|hell|hells|helvete|henhouse|hentai|heroin|herp|herpes|herpy|heshe|hijacker|hijacking|hillbillies|hillbilly|hindoo|hiscock|hitler|hitlerism|hitlerist|ho|hobag|hodgie|hoe|hoer|hoes|holestuffer|hom0|homey|homicide|homo|homobangers|homodumbshit|homoey|honger|honkers|honkey|honkeys|honkie|honkies|honky|hooch|hooker|hookers|hoor|hoore|hootch|hooter|hooters|hore|hori|horis|hork|horndawg|horndog|horney|horniest|horny|horseshit|hosejob|hoser|hot carl|hot chick|hotcarl|hotdamn|hotpussy|hotsex|hottotrot|how to kill|how to murder|huevon|huge fat|hugefat|hui|hummer|humped|humper|humpher|humphim|humpin|humping|husky|hussy|hustler|hymen|hymie|hymies|iblowu|ike|ikes|ikey|ikeymo|ikeymos|ikwe|illegal|illegals|inbred|incest|indon|indons|injun|injuns|insest|intercourse|interracial|intheass|inthebuff|israels|j3rk0ff|jack off|jack-off|jackass|jackhole|jackoff|jackshit|jacktheripper|jail bait|jailbait|jap|japcrap|japie|japies|japs|jebus|jelly donut|jerk off|jerk|jerk-off|jerk0ff|jerked|jerkoff|jerries|jerry|jesuschrist|jewed|jewess|jig|jiga|jigaboo|jigaboos|jigarooni|jigaroonis|jigg|jigga|jiggabo|jiggaboo|jiggabos|jiggas|jigger|jiggerboo|jiggers|jiggs|jiggy|jigs|jihad|jijjiboo|jijjiboos|jimfish|jisim|jism|jiss|jiz|jizim|jizin|jizjuice|jizm|jizn|jizz|jizzd|jizzed|jizzim|jizzin|jizzn|jizzum|jugg|juggs|jugs|jungle bunnies|jungle bunny|junglebunny|junkie|junky|kacap|kacapas|kacaps|kaffer|kaffir|kaffre|kafir|kanake|kanker|katsap|katsaps|kawk|khokhol|khokhols|kicking|kigger|kike|kikes|killer|kills|kimchis|kinbaku|kink|kinkster|kinky|kissass|kkk|klan|klansman|klansmen|klanswoman|klanswomen|klootzak|knobbing|knobead|knobed|knobend|knobhead|knobjocky|knobjokey|knobz|knockers|knulle|kock|kondum|kondums|kooch|kooches|koon|kootch|krap|krappy|kraut|krauts|kuffar|kuk|kuksuger|kum|kumbubble|kumbullbe|kumer|kummer|kumming|kumquat|kums|kunilingus|kunnilingus|kunt|kunts|kuntz|kurac|kurwa|kushi|kushis|kusi|kwa|kwai lo|kwai los|ky|kyke|kykes|kyopo|kyopos|kyrpa|l3i+ch|l3i\+ch|l3itch|labia|lapdance|lds|leather restraint|leather straight jacket|leather straight|leatherrestraint|lebo|lebos|lech|lemon party|lemonparty|leper|lesbain|lesbayn|lesbian|lesbin|lesbo|lez|lezbe|lezbefriends|lezbian|lezbians|lezbo|lezbos|lezz|lezzian|lezzie|lezzies|lezzo|lezzy|libido|licker|licking|lickme|lilniglet|limey|limpdick|limy|lingerie|lipshits|lipshitz|livesex|lmfao|loadedgun|loin|loins|lolita|lovebone|lovegoo|lovegun|lovejuice|lovemaking|lovemuscle|lovepistol|loverocket|lowlife|lsd|lubejob|lubra|lucifer|luckycammeltoe|lugan|lugans|lust|lusting|lusty|lynch|m-fucking|m0f0|m0fo|m45terbate|ma5terb8|ma5terbate|mabuno|mabunos|macaca|macacas|magicwand|mahbuno|mahbunos|make me come|makemecome|makemecum|male squirting|mamhoon|mams|manhater|manpaste|maricon|maricón|marijuana|masochist|masokist|massa|massterbait|masstrbait|masstrbate|mastabate|mastabater|master-bate|masterb8|masterbaiter|masterbat|masterbat3|masterbate|masterbates|masterbating|masterbation|masterbations|masterblaster|mastrabator|masturbat|masturbate|masturbating|masturbation|mattressprincess|mau mau|mau maus|maumau|maumaus|mcfagget|meatbeatter|meatrack|menage a trois|menage|menses|menstruate|menstruation|merd|meth|mgger|mggor|mibun|mick|mickeyfinn|mideast|mierda|milf|minge|missionary position|missionary|mo-fo|mockey|mockie|mocky|mof0|mofo|moky|molest|molestation|molester|molestor|moneyshot|monkleigh|moolie|moon cricket|moon crickets|mooncricket|mooncrickets|mormon|moron|moskal|moskals|moslem|mosshead|motha fucker|motha fuker|motha fukkah|motha fukker|mothafuck|mothafucka|mothafuckas|mothafuckaz|mothafucked|mothafucker|mothafuckers|mothafuckin|mothafucking|mothafuckings|mothafucks|mother fucker|mother fukah|mother fuker|mother fukkah|mother fukker|mother-fucker|motherfuck|motherfucka|motherfucked|motherfucker|motherfuckers|motherfuckin|motherfucking|motherfuckings|motherfuckka|motherfucks|motherfvcker|motherlovebone|mothrfucker|mthrfuck|mthrfucker|mthrfucking|mtrfck|mtrfuck|mtrfucker|muff diver|muff|muffdive|muffdiver|muffdiving|muffindiver|mufflikcer|muie|mulatto|mulkku|muncher|munging|munt|murder|murderer|muschi|mutha fucker|mutha fukah|mutha fuker|mutha fukkah|mutha fukker|mutha|muthafecker|muthafuckaz|muthafucker|muthafuckker|muther|mutherfucker|mutherfucking|muthrfucking|mzungu|mzungus|n1gga|n1gger|n1gr|nad|nads|naked|nambla|nastt|nasty|nastybitch|nastyho|nastyslut|nastywhore|nawashi|nazi|nazis|nazism|necro|negres|negress|negro|negroes|negroid|negros|neonazi|nepesaurio|nig nog|nig|niga|nigar|nigars|nigas|niger|nigerian|nigerians|nigers|nigette|nigettes|nigg|nigg3r|nigg4h|nigga|niggah|niggahs|niggar|niggaracci|niggard|niggarded|niggarding|niggardliness|niggardlinesss|niggardly|niggards|niggars|niggas|niggaz|nigger|niggerhead|niggerhole|niggers|niggle|niggled|niggles|niggling|nigglings|niggor|niggress|niggresses|nigguh|nigguhs|niggur|niggurs|niglet|nignog|nigor|nigors|nigr|nigra|nigras|nigre|nigres|nigress|nigs|nigur|niiger|niigr|nimphomania|nimrod|ninny|nip|nipple|nipplering|nipples|nips|nittit|nlgger|nlggor|nob jokey|nob|nobhead|nobjocky|nobjokey|nofuckingway|nog|nookey|nookie|nooky|noonan|nooner|nsfw images|nsfw|nude|nudger|nudie|nudies|nudity|numbnuts|nut sack|nutfucker|nutsack|nymph|nympho|nymphomania|o c k|octopussy|omorashi|one cup two girls|one guy one jar|one guy|one jar|ontherag|orafis|oral|orally|orga|orgasim|orgasim;|orgasims|orgasm|orgasmic|orgasms|orgasum|orgies|orgy|oriface|orifice|orifiss|orospu|osama|ovum|ovums|p e n i s|p i s|p u s s y|p.u.s.s.y.|p0rn|packi|packie|packy|paddy|paedophile|paki|pakie|pakis|paky|palesimian|pancake face|pancake faces|panooch|pansies|pansy|panti|pantie|panties|panty|paska|pastie|pasty|payo|pcp|pearlnecklace|peck|pecker|peckerhead|peckerwood|pedo|pedobear|pedophile|pedophilia|pedophiliac|pee|peeenus|peeenusss|peehole|peenus|peepee|peepshow|peepshpw|pegging|peinus|pen1s|penas|pendejo|pendy|penetrate|penetration|peni5|penial|penile|penis|penis-breath|penises|penisfucker|penisland|penislick|penislicker|penispuffer|penthouse|penus|penuus|perse|perv|perversion|peyote|phalli|phallic|phone sex|phonesex|phuc|phuck|phuk|phuked|phuker|phuking|phukked|phukker|phukking|phuks|phungky|phuq|pi55|picaninny|piccaninny|picka|pickaninnies|pickaninny|piece of shit|pieceofshit|piefke|piefkes|pierdol|pigfucker|piker|pikey|piky|pillowbiter|pillu|pimmel|pimp|pimped|pimper|pimpis|pimpjuic|pimpjuice|pimpsimp|pindick|pinko|pis|pises|pisin|pising|pisof|piss pig|piss|piss-off|pissed|pisser|pissers|pisses|pissflaps|pisshead|pissin|pissing|pissoff|pisspig|pistol|pizda|playboy|playgirl|pleasure chest|pleasurechest|pms|pocha|pochas|pocho|pochos|pocketpool|pohm|pohms|polac|polack|polacks|polak|pole smoker|polesmoker|pollock|pollocks|pommie grant|pommie grants|pommie|pommies|pommy|ponyplay|poo|poof|poon|poonani|poonany|poontang|poontsee|poop chute|poop|poopchute|pooper|pooperscooper|pooping|poorwhitetrash|popimp|porch monkey|porch monkies|porchmonkey|porn|pornflick|pornking|porno|pornography|pornos|pornprincess|pound town|poundtown|pplicker|pr0n|pr1c|pr1ck|pr1k|prairie nigger|prairie niggers|premature|preteen|pric|prick|prickhead|pricks|prig|prince albert piercing|pron|propaganda|prostitute|pthc|pu55i|pu55y|pube|pubes|pubic|pubiclice|pubis|pud|pudboy|pudd|puddboy|puke|pula|pule|punanny|punany|punkass|punky|punta|puntang|purinapricness|pusies|puss|pusse|pussee|pussi|pussie|pussies|pussy|pussycat|pussydestroyer|pussyeater|pussyfucker|pussylicker|pussylicking|pussylips|pussylover|pussypounder|pussys|pusy|puta|puto|puuke|puuker|qahbeh|quashie|queaf|queef|queero|queers|queerz|quickie|quicky|quiff|quim|qweers|qweerz|qweir|r-tard|r-tards|r5e|ra8s|racial|radicals|raghead|ragheads|raging boner|raging|ragingboner|randy|rape|raped|raper|raping|rapist|raunch|rautenberg|rearend|rearentry|recktum|rectal|rectum|rectus|redleg|redlegs|redlight|redneck|rednecks|redskin|redskins|reefer|reestie|reetard|refugee|reich|renob|rentafuck|rere|retard|retarded|retards|retardz|reverse cowgirl|reversecowgirl|rigger|rimjaw|rimjob|rimming|ritard|rosebuds|rosy palm and her 5 sisters|rosy palm|rosypalm|rosypalmandher5sisters|rosypalmandherefivesisters|round eyes|roundeye|rtard|rtards|rump|rumprammer|ruski|russki|russkie|rusty trombone|rustytrombone|s h i t|s hit|s&m|s-h-1-t|s-h-i-t|s-o-b|s.h.i.t.|s.o.b.|s0b|s_h_i_t|sac|sack|sadis|sadism|sadist|sadom|sambo|sambos|samckdaddy|sanchez|sand nigger|sand niggers|sandm|sandnigger|santorum|scag|scallywag|scank|scantily|scat|schaffer|scheiss|schizo|schlampe|schlong|schmuck|schvartse|schvartsen|schwartze|schwartzen|scissoring|screwed|screwing|screwyou|scroat|scrog|scrot|scrote|scrotum|scrud|seduce|semen|seppo|seppos|septics|sex|sexed|sexfarm|sexhound|sexhouse|sexi|sexing|sexkitten|sexo|sexpot|sexslave|sextogo|sextoy|sextoys|sexual|sexually|sexwhore|sexx|sexxi|sexxx|sexxxi|sexxxy|sexxy|sexy|sexymoma|sexyslim|sh!+|sh!t|sh1t|sh1ter|sh1ts|sh1tter|sh1tz|shag|shagger|shaggin|shagging|shamedame|sharmuta|sharmute|shat|shav|shaved beaver|shaved pussy|shaved|shavedbeaver|shavedpussy|shawtypimp|sheeney|shemale|shhit|shi+|shibari|shinola|shipal|shit|shitass|shitbag|shitbagger|shitblimp|shitbrain|shitbreath|shitcan|shitcunt|shitdick|shite|shiteater|shited|shitey|shitface|shitfaced|shitfit|shitforbrains|shitfuck|shitfucker|shitfull|shithapens|shithappens|shithead|shithole|shithouse|shiting|shitings|shitlist|shitola|shitoutofluck|shits|shitspitter|shitstain|shitt|shitted|shitter|shitters|shittiest|shitting|shittings|shitty|shity|shitz|shiz|shiznit|shortfuck|shota|shrimping|shylock|shylocks|shyt|shyte|shytty|shyty|sissy|sixsixsix|sixtynine|sixtyniner|skag|skanck|skank|skankbitch|skankee|skankey|skankfuck|skanks|skankwhore|skanky|skankybitch|skankywhore|skeet|skinflute|skribz|skullfuck|skum|skumbag|skurwysyn|skwa|skwe|slag|slant|slanteye|slanty|slapper|slaughter|slave|slavedriver|sleaze|sleazy|sleezebag|sleezeball|slideitin|slimeball|slimebucket|slopehead|slopeheads|sloper|slopers|slopes|slopey|slopeys|slopies|slopy|slut|slutbag|slutdumper|slutkiss|sluts|slutt|slutting|slutty|slutwear|slutwhore|slutz|smack|smackthemonkey|smeg|smegma|smoker|smut|smutty|snatch|snatchpatch|snigger|sniggered|sniggering|sniggers|sniper|snowback|snowballing|snownigger|snuff|sob|socksucker|sodom|sodomise|sodomite|sodomize|sodomy|son of a bitch|son-of-a-bitch|sonofabitch|sonofbitch|sooties|sooty|souse|soused|spac|spade|spades|spaghettibender|spaghettinigger|spank|spankthemonkey|spearchucker|spearchuckers|sperm|spermacide|spermbag|spermhearder|spermherder|sphencter|spic|spick|spicks|spics|spierdalaj|spig|spigotty|spik|spiks|spitter|splittail|splooge moose|splooge|spludge|spooge|spread legs|spreadeagle|spunk|spunky|sqeh|squa|squarehead|squareheads|squaw|squinty|squirting|stagg|steamy|stfu|stiffy|stoned|stoner|strap on|strapon|strappado|stringer|strip club|stripclub|stroke|stroking|stuinties|stupid|stupidfuck|stupidfucker|style doggy|suck|suckdick|sucked|sucker|sucking|suckme|suckmyass|suckmydick|suckmytit|suckoff|sucks|suicide girl|suicide girls|suicide|suicidegirl|suicidegirls|suka|sultry women|sultry|sultrywoman|sultrywomen|sumofabiatch|swallow|swallower|swalow|swamp guinea|swamp guineas|swastika|swinger|syphilis|t i t|t i ts|t1t|t1tt1e5|t1tties|taboo|tacohead|tacoheads|taff|tainted love|tainted|take off your|tantra|tar babies|tar baby|tarbaby|tard|taste my|tastemy|tawdry|tea bagging|teabagging|teat|teets|teez|terd|terror|terrorist|teste|testee|testes|testical|testicle|testicles|testis|thicklip|thicklips|thirdeye|thirdleg|threesome|threeway|throat|throating|thrust|thug|thundercunt|ti|tied up|tight white|timber nigger|timber niggers|timbernigger|tinkle|tit|titbitnipply|titfuck|titfucker|titfuckin|titi|titjob|titlicker|titlover|tits|titt|tittie|tittie5|tittiefucker|titties|tittis|titty|tittyfuck|tittyfucker|tittys|tittywank|titwank|tity|to murder|toke|tongethruster|tongue in a|tongueina|tonguethrust|tonguetramp|toots|topless|tortur|torture|tosser|towel head|towel heads|towelhead|trailertrash|tramp|trannie|tranny|transsexual|transvestite|trashy|tribadism|triplex|trisexual|trois|trojan|trombone|trots|tub girl|tubgirl|tuckahoe|tunneloflove|turd|turnon|tush|tushy|tw4t|twat|twathead|twatlips|twats|twatty|twatwaffle|twink|twinkie|two girls one cup|twobitwhore|twunt|twunter|udge packer|ukrop|uncle tom|unclefucker|undies|undressing|unfuckable|unwed|upskirt|uptheass|upthebutt|urethra play|urethra|urethraplay|urinal|urinary|urinate|urine|urophilia|usama|ussys|uzi|v a g i n a|v14gra|v1gra|v4gra|va-j-j|va1jina|vag|vag1na|vagiina|vagina|vaginal|vaj1na|vajina|valium|venus mound|vgra|viagra|vibe|vibr|vibrater|vibrator|vietcong|violet wand|virgin|virginbreaker|vittu|vixen|vjayjay|vodka|vomit|vorarephilia|voyeur|vulgar|vullva|vulva|w00se|w0p|wab|wad|wang|wank|wanker|wanking|wanky|waysted|wazoo|wedgie|weed|weenie|weewee|weiner|weirdo|welcher|wench|wet dream|wetb|wetback|wetbacks|wetdream|wetspot|wh00r|wh0re|wh0reface|whacker|whash|whigger|whiggers|whiskeydick|whiskydick|whit|white power|white trash|whitenigger|whitepower|whites|whitetrash|whitey|whiteys|whities|whiz|whoar|whop|whoralicious|whore|whorealicious|whorebag|whored|whoreface|whorefucker|whorehopper|whorehouse|whores|whoring|wichser|wigga|wiggas|wigger|wiggers|willie|willies|williewanker|willy|wn|wog|wogs|woody|wop|wrapping men|wrinkled starfish|wtf|wuss|wuzzie|x-rated|xkwe|xrated|xtc|xx|xxx|xxxxxx|yank|yaoi|yarpie|yarpies|yeasty|yed|yellow showers|yellowman|yellowshowers|yid|yids|yiffy|yobbo|yourboobs|yourpenis|yourtits|zabourah|zigabo|zigabos|zipperhead|zipperheads|zoophile|zoophilia|🖕" data-flags="giu">Profanity Filter (Extensive)</option>
                        </optgroup>
                        
                        <optgroup label="Finance (Global)">
                            <option data-pattern="\b[A-Z]{2}\d{2}[A-Z0-9]{11,30}\b" data-flags="g">IBAN (General)</option>
                            <option data-pattern="^\b[A-Z]{6}[A-Z0-9]{2}([A-Z0-9]{3})?\b$" data-flags="g,m">SWIFT Code</option>
                            <option data-pattern="^\b((0[0-9])|(1[0-2])|(2[1-9])|(3[0-2])|(6[1-9])|(7[0-2])|80)([0-9]{7})\b$" data-flags="g,m">ABA Routing Number (US)</option>
                            <option data-pattern="\b4[0-9]{12}(?:[0-9]{3})?\b" data-flags="g">Visa Card</option>
                            <option data-pattern="\b(?:5[1-5][0-9]{2}|222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}\b" data-flags="g">MasterCard</option>
                            <option data-pattern="\b3[47][0-9]{13}\b" data-flags="g">American Express</option>
                            <option data-pattern="^(?:6011\d{12})|(?:65\d{14})$" data-flags="g">Discover Card</option>
                        </optgroup>
                        
                        <optgroup label="National IDs (Europe)">
                            <option data-pattern="^[0-9]{10}$" data-flags="g,m">Austria - Social Insurance (ASVG)</option>
                            <option data-pattern="^[0-9]{2}\.?[0-9]{2}\.?[0-9]{2}-[0-9]{3}\.?[0-9]{2}$" data-flags="g,m">Belgium - National Number (NISS)</option>
                            <option data-pattern="^\d{10}$" data-flags="g,m">Bulgaria - Uniform Civil Number (EGN)</option>
                            <option data-pattern="\b\d{6}[A-Z]?\b" data-flags="g,i">Cyprus - ID Card / ARC</option>
                            <option data-pattern="^\d{11}$" data-flags="g,m">Croatia - Personal ID (OIB)</option>
                            <option data-pattern="^((((0[1-9]|[12][0-9]|3[01])(0[13578]|10|12)(\d{2}))|(([0][1-9]|[12][0-9]|30)(0[469]|11)(\d{2}))|((0[1-9]|1[0-9]|2[0-8])(02)(\d{2}))|((29)(02)(00))|((29)(02)([2468][048]))|((29)(02)([13579][26])))[-]\d{4})$" data-flags="g,m">Denmark - Social Security (CPR)</option>
                            <option data-pattern="^\d{11}$" data-flags="g,m">Estonia - Personal ID (Isikukood)</option>
                            <option data-pattern="^[0-9]{2}\.?[0,1][0-9]\.?[0-9]{2}[-+A][0-9]{3}[A-Z]$" data-flags="g,i,m">Finland - Personal ID (HETU)</option>
                            <option data-pattern="^\b\d{13}|\d{13}\s\d{2}\b$" data-flags="g,m">France - Social Security (INSEE)</option>
                            <option data-pattern="^\b\b\d{12}\b\b$" data-flags="g,m">France - National ID (CNI)</option>
                            <option data-pattern="^[0-9]{3}/?[0-9]{4}/?[0-9]{4}$" data-flags="g,m">Germany - Tax ID (Steuer-ID)</option>
                            <option data-pattern="\b[LMNPRTVWXY][0-9CFGHJKLMNPRTVWXY]{8}\b" data-flags="g,i">Germany - Identity Card (Personalausweisnummer)</option>
                            <option data-pattern="^\d{11}$" data-flags="g,m">Greece - Social Security (AMKA)</option>
                             <option data-pattern="\b[ΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩ]{1,2}\d{6}\b" data-flags="g,i">Greece - Police ID (ADT)</option>
                            <option data-pattern="^[0-9]{7}[A-Z]W?$" data-flags="g,i,m">Ireland - PPS Number</option>
                            <option data-pattern="^[A-Z]{6}[0-9]{2}[A-E,H,L,M,P,R-T][0-9]{2}[A-Z0-9]{5}$" data-flags="g,i,m">Italy - Codice Fiscale</option>
                            <option data-pattern="^\d{11}$" data-flags="g,m">Lithuania - Personal Code (Asmens kodas)</option>
                            <option data-pattern="^[0-9]{9}$" data-flags="g,m">Netherlands - BSN Number</option>
                             <option data-pattern="^\d{11}$" data-flags="g,m">Norway - National ID (Fødselsnummer)</option>
                            <option data-pattern="^\d{11}$" data-flags="g,m">Poland - National ID (PESEL)</option>
                            <option data-pattern="^(ES)?[0-9A-Z][0-9]{7}[0-9A-Z]$" data-flags="g,i,m">Spain - VAT Number</option>
                            <option data-pattern="^(\d{6}|\d{8})[-|(\s)]{0,1}\d{4}$" data-flags="g,m">Sweden - Social Security (Personnummer)</option>
                            <option data-pattern="^\b\d{3}\s\d{3}\s\d{4}\b$" data-flags="g,m">UK - NHS Number</option>
                            <option data-pattern="^[A-Z]{2}[0-9]{6}[A-DFM]{1}$" data-flags="g,m">UK - National Insurance (NINO)</option>
                        </optgroup>
                        
                        <optgroup label="National IDs (North America)">
                            <option data-pattern="\b\d{3}-\d{2}-\d{4}\b" data-flags="g">USA - Social Security (SSN)</option>
                            <option data-pattern="\b\(?(\d{3})\)?[-. ]?(\d{3})[-. ]?(\d{4})\b" data-flags="g">USA - Phone Number</option>
                            <option data-pattern="\b\d{3}[- ]?\d{3}[- ]?\d{3}\b" data-flags="g">Canada - Social Insurance (SIN)</option>
                        </optgroup>

                        <optgroup label="National IDs (Asia-Pacific / Other)">
                            <option data-pattern="\b\d{3} \d{3} \d{3}\b" data-flags="g">Australia - Tax File Number (TFN)</option>
                            <option data-pattern="\b\d{3}\.\d{3}\.\d{3}-\d{2}\b" data-flags="g">Brazil - CPF Number</option>
                             <option data-pattern="\b\d{1,2}\.?\d{3}\.?\d{3}-?[\dX]\b" data-flags="g,i">Brazil - RG Number</option>
                            <option data-pattern="\b\d{17}[\dX]\b" data-flags="g,i">China - ID Card (18-digit)</option>
                            <option data-pattern="\b[A-Z]{5}\d{4}[A-Z]\b" data-flags="g,i">India - PAN Card</option>
                             <option data-pattern="\b\d{4}[ -]?\d{4}[ -]?\d{4}\b" data-flags="g">India - Aadhaar Number</option>
                            <option data-pattern="^\d{12}$" data-flags="g,m">Japan - My Number (個人番号)</option>
                             <option data-pattern="^\d{6}-\d{7}$" data-flags="g,m">South Korea - Resident Reg No (RRNO)</option>
                             <option data-pattern="^\d{6}-\d{2}-\d{4}$" data-flags="g,m">Malaysia - NRIC Number</option>
                             <option data-pattern="\b[STFG]\d{7}[A-Z]\b" data-flags="g,i">Singapore - NRIC/FIN</option>
                             <option data-pattern="\b\d{9}|\d{12}\b" data-flags="g,m">Vietnam - ID Card Number (CCCD/CMND)</option>
                             <option data-pattern="\b\d{11}\b" data-flags="g,m">Turkey - National ID (TC Kimlik)</option>
                             <option data-pattern="\b\d{11}\b" data-flags="g,m">Qatar - QID Number</option>
                             <option data-pattern="\b784-\d{4}-\d{7}-\d{1}\b" data-flags="g">United Arab Emirates - ID Card Number</option>
                        </optgroup>
                        
                        <optgroup label="Passports">
                            <option data-pattern="^[a-zA-Z]{2}\d{6}$" data-flags="g,i">Belgium / Brazil - Passport</option>
                            <option data-pattern="^\d{10}$" data-flags="g,m">Bulgaria - Passport</option>
                            <option data-pattern="^[A-Za-z]{2}[0-9]{7}$" data-flags="g,i">Finland / Lithuania - Passport</option>
                            <option data-pattern="\b\d{2}[A-Z]{2}\d{5}\b" data-flags="g,i">France - Passport</option>
                            <option data-pattern="^\b[cfghjk]\d{3}\w{5}\d\b$|[CFGHJKLMNPRTVWXY0-9]{9}" data-flags="g,i,m">Germany - Passport ID</option>
                            <option data-pattern="^[A-Z]{2}\d{7}$" data-flags="g,i">Greece / Italy / Poland - Passport</option>
                            <option data-pattern="^[N]{1}[P]{1}\d{7}$" data-flags="g,i">Netherlands - Passport</option>
                            <option data-pattern="\b\d{9}\b" data-flags="g,m">UK/Norway/Sweden/Denmark/Croatia/Estonia/Cyprus/USA/Qatar - Passport ID</option>
                           <option data-pattern="^(G|P|S|E)\d{8}$" data-flags="g,i">China - Passport</option>
                           <option data-pattern="^[A-Z]{1}\d{7}$" data-flags="g,i">India / Turkey - Passport</option>
                           <option data-pattern="^[A-Z]{2}\d{7}$" data-flags="g,i">Japan - Passport (2020+)</option>
                           <option data-pattern="^[MSR]\d{8}$" data-flags="g,i">South Korea - Passport</option>
                           <option data-pattern="^[AHK]\d{8}$" data-flags="g,i">Malaysia - Passport</option>
                           <option data-pattern="^[EK]\d{8}$" data-flags="g,i">Singapore - Passport</option>
                           <option data-pattern="^[A-Z]{1}\d{8}$" data-flags="g,i">United Arab Emirates - Passport</option>
                           <option data-pattern="^[BCN]\d{7}$" data-flags="g,i">Vietnam - Passport</option>
                        </optgroup>

                        <optgroup label="Postal Codes">
                            <option data-pattern="^\b\d{5}(?:-\d{4})?\b$" data-flags="g,m">USA - ZIP Code</option>
                            <option data-pattern="^(?:[ABCEGHJ-NPRSTVXY]\d[A-Z][ -]?\d[A-Z]\d)$" data-flags="g,i,m">Canada - Postal Code</option>
                            <option data-pattern="^\d{4}$" data-flags="g,m">Belgium / Denmark / Norway / Bulgaria / Cyprus - Postal Code</option>
                            <option data-pattern="^\d{5}$" data-flags="g,m">Germany / France / Finland / Spain / Italy / Estonia / Greece / Croatia / Lithuania / Turkey / Vietnam / Malaysia / UAE / Qatar - Postal Code</option>
                             <option data-pattern="\b\d{3} ?\d{2}\b" data-flags="g,m">Greece - Postal Code</option>
                             <option data-pattern="\d{2}-\d{3}" data-flags="g,m">Poland - Postal Code</option>
                             <option data-pattern="^(LT-)?\d{5}$" data-flags="g,m">Lithuania - Postal Code</option>
                            <option data-pattern="^\b\d{5}\b" data-flags="g,m">Brazil / South Korea - Postal Code</option>
                            <option data-pattern="\b\d{3}-\d{4}\b" data-flags="g,m">Japan - Postal Code</option>
                            <option data-pattern="^([A-PR-UWYZ0-9][A-HK-Y0-9][AEHMNPRTVXY0-9]?[ABEHMNPRVWXY0-9]? {1,2}[0-9][ABD-HJLN-UW-Z]{2}|GIR 0AA)$" data-flags="g,i,m">UK - Postal Code</option>
                            <option data-pattern="^(?:NL-)?(?:[1-9]\d{3} ?(?:[A-EGHJ-NPRTVWXZ][A-EGHJ-NPRSTVWXZ]|S[BCEGHJ-NPRTVWXZ]))$" data-flags="g,i,m">Netherlands - Postal Code</option>
                            <option data-pattern="^(s-|S-){0,1}[0-9]{3}\s?[0-9]{2}$" data-flags="g,i,m">Sweden - Postal Code</option>
                            <option data-pattern="^\d{6}$" data-flags="g,m">Singapore / China / India - Postal Code</option>
                        </optgroup>

                         <optgroup label="Phone Numbers (Specific Countries)">
                             <option data-pattern="\+1[ -]?\(?\d{3}\)?[-. ]?\d{3}[-. ]?\d{4}" data-flags="g">USA/Canada - Phone</option>
                             <option data-pattern="\+32[ -]?\d{1,3}[ -]?\d{6,8}" data-flags="g">Belgium - Phone</option>
                             <option data-pattern="\+55[ -]?\(?\d{2}\)?[- ]?\d{4,5}[- ]?\d{4}" data-flags="g">Brazil - Phone</option>
                             <option data-pattern="\+359[ -]?\d{1,3}[ -]?\d{6,}" data-flags="g">Bulgaria - Phone</option>
                             <option data-pattern="\+86[ -]?\d{3,4}[ -]?\d{7,8}" data-flags="g">China - Phone</option>
                             <option data-pattern="\+385[ -]?\d{1,2}[ -]?\d{6,}" data-flags="g">Croatia - Phone</option>
                             <option data-pattern="\+357[ -]?\d{8}" data-flags="g">Cyprus - Phone</option>
                             <option data-pattern="\+45[ -]?\d{8}" data-flags="g">Denmark - Phone</option>
                             <option data-pattern="\+372[ -]?\d{7,8}" data-flags="g">Estonia - Phone</option>
                             <option data-pattern="\+358[ -]?\d{1,3}[ -]?\d{5,8}" data-flags="g">Finland - Phone</option>
                             <option data-pattern="\+33[ -]?[1-9](?:[ -]?\d{2}){4}" data-flags="g">France - Phone</option>
                             <option data-pattern="\+49[ -]?(\d{2,5}[ -]?\d{6,})|\(0\d{2,5}\)[ -]?\d{6,}|0\d{2,5}[ -]?\d{6,}" data-flags="g">Germany - Phone</option>
                             <option data-pattern="\+30[ -]?\d{10}" data-flags="g">Greece - Phone</option>
                             <option data-pattern="\+91[ -]?\d{10}" data-flags="g">India - Phone</option>
                             <option data-pattern="\+39[ -]?\d{6,11}" data-flags="g">Italy - Phone</option>
                             <option data-pattern="\+81[ -]?\d{1,4}[ -]?\d{1,4}[ -]?\d{4}" data-flags="g">Japan - Phone</option>
                             <option data-pattern="\+370[ -]?\d{8}" data-flags="g">Lithuania - Phone</option>
                             <option data-pattern="\+60[ -]?\d{1,2}[ -]?\d{7,8}" data-flags="g">Malaysia - Phone</option>
                             <option data-pattern="\+31[ -]?\d{1,3}[ -]?\d{6,8}" data-flags="g">Netherlands - Phone</option>
                             <option data-pattern="\+47[ -]?\d{8}|(?:\d{2}[ -]?){3}\d{2}" data-flags="g">Norway - Phone</option>
                             <option data-pattern="\+48[ -]?\d{9}" data-flags="g">Poland - Phone</option>
                             <option data-pattern="\+974[ -]?\d{8}" data-flags="g">Qatar - Phone</option>
                             <option data-pattern="\+65[ -]?\d{8}" data-flags="g">Singapore - Phone</option>
                             <option data-pattern="\+82[ -]?\d{1,2}[ -]?\d{3,4}[ -]?\d{4}" data-flags="g">South Korea - Phone</option>
                             <option data-pattern="\+46[ -]?\(?0?\)?\d{1,3}[ -]?\d{5,8}" data-flags="g">Sweden - Phone</option>
                             <option data-pattern="\+90[ -]?\(?\d{3}\)?[- ]?\d{3}[- ]?\d{4}" data-flags="g">Turkey - Phone</option>
                             <option data-pattern="\+971[ -]?\d{1,2}[ -]?\d{7}" data-flags="g">United Arab Emirates - Phone</option>
                             <option data-pattern="\+44[ -]?\d{4}[ -]?\d{6}|\(?0\d{4}\)?[ -]?\d{6}|0\d{10}" data-flags="g">UK - Phone</option>
                             <option data-pattern="\+84[ -]?\d{9,10}" data-flags="g">Vietnam - Phone</option>
                        </optgroup>

                        <optgroup label="Security Related (Basic)">
                            <option data-pattern="(['";\-=]|--|\b(UNION|SELECT|INSERT|UPDATE|DELETE|DROP)\b)" data-flags="gi">Potential SQL Injection</option>
                             <option data-pattern="<script.*?>.*?<\/script>" data-flags="gi">Potential XSS (Script Tag)</option>
                        </optgroup>
                    </select>
                </div>
                <div class="text-group">
                    <div class="section-header">
                        <h2>Test Text</h2>
                        <div class="button-group">
                            <button class="btn copy-btn" id="copy-text-btn" data-target="text-input">Copy</button>
                            <button class="btn btn-secondary clear-btn" id="clear-text-btn" data-target="text-input">Clear</button>
                        </div>
                    </div>
                    <div class="text-input-wrapper">
                        <label>Test Text</label>
                        <div id="highlight-output" class="editor-base"></div>
                        <textarea id="text-input" class="editor-base" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off"></textarea>
                    </div>
                </div>
                
                <div class="file-scanner">
                    <h2>File Scanner</h2>
                    <input type="file" id="file-input" accept=".txt,.csv,.json,.xml,.log">
                    <button class="btn btn-primary" id="scan-file-btn">Scan File & Download Report</button>
                    <div id="scan-status"></div>
                </div>
                <div class="replace-group">
                    <div class="section-header">
                        <h2>Substitution</h2>
                        <div class="button-group">
                             <button class="btn btn-secondary clear-btn" id="clear-replace-btn" data-target="replacement-input">Clear</button>
                        </div>
                    </div>
                    <div class="md-textfield">
                        <textarea id="replacement-input" placeholder=" " rows="2"></textarea>
                        <label for="replacement-input">Replacement String (use $1, $2...)</label>
                    </div>
                </div>

            </div>
            
            <div class="output-column">

                <div class="output-group">
                    <h2>Matches</h2>
                    <pre id="result-output" class="output-box"></pre>
                </div>
                
                <div class="output-group">
                    <div class="section-header">
                        <h2>Replacement Result</h2>
                        <button class="btn copy-btn" id="copy-result-btn" data-target="replace-output">Copy</button>
                    </div>
                    <pre id="replace-output" class="output-box"></pre>
                </div>

                <details class="cheatsheet-group">
                    <summary>Regex Cheat Sheet</summary>
                    <div class="cheatsheet-content">
                        <table>
                            <tr><th>Token</th><th>Description</th></tr>
                            <tr><td><code>.</code></td><td>Any char except newline</td></tr>
                            <tr><td><code>\d</code>, <code>\w</code>, <code>\s</code></td><td>Digit, Word, Whitespace</td></tr>
                            <tr><td><code>\D</code>, <code>\W</code>, <code>\S</code></td><td>Not Digit, Word, Whitespace</td></tr>
                            <tr><td><code>[abc]</code></td><td>Any of a, b, or c</td></tr>
                            <tr><td><code>[^abc]</code></td><td>Not a, b, or c</td></tr>
                            <tr><td><code>[a-z]</code></td><td>Chars a through z</td></tr>
                            <tr><td><code>a|b</code></td><td>a or b</td></tr>
                            <tr><td><code>^</code>, <code>$</code></td><td>Start/End of string (or line with <code>m</code>)</td></tr>
                            <tr><td><code>\b</code>, <code>\B</code></td><td>Word boundary, Not word boundary</td></tr>
                            <tr><td><code>*</code>, <code>+</code>, <code>?</code></td><td>0+, 1+, 0 or 1 repetition</td></tr>
                            <tr><td><code>{n}</code>, <code>{n,}</code>, <code>{n,m}</code></td><td>Exactly n, n or more, between n and m</td></tr>
                            <tr><td><code>(...)</code></td><td>Capture Group</td></tr>
                            <tr><td><code>(?:...)</code></td><td>Non-capturing group</td></tr>
                            <tr><td><code>(?=...)</code></td><td>Positive lookahead</td></tr>
                            <tr><td><code>(?!...)</code></td><td>Negative lookahead</td></tr>
                        </table>
                    </div>
                </details>
            </div>

        </div> <p class="footer-credit">Created by Jonas Lund 2025</p>
        
    </div> <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Get All DOM Elements ---
            const regexInput = document.getElementById('regex-input');
            const textInput = document.getElementById('text-input');
            const replacementInput = document.getElementById('replacement-input');
            const resultOutput = document.getElementById('result-output');
            const replaceOutput = document.getElementById('replace-output');
            const highlightOutput = document.getElementById('highlight-output');
            const errorMessage = document.getElementById('error-message');
            const patternLibrary = document.getElementById('pattern-library');
            
            // Flag toggles
            const flagToggles = document.querySelectorAll('.flag-toggle input[type="checkbox"]');
            
            // Copy buttons
            const copyButtons = document.querySelectorAll('.copy-btn');
            
            // Clear Buttons
            const clearButtons = document.querySelectorAll('.clear-btn');

            // --- File Scanner Elements ---
            const fileInput = document.getElementById('file-input');
            const scanFileBtn = document.getElementById('scan-file-btn');
            const scanStatus = document.getElementById('scan-status');
            
            // LocalStorage key
            const STORAGE_KEY = 'regexTesterSession';

            // --- Helper Functions ---
            
            /**
             * Escapes HTML special characters to prevent XSS.
             * @param {string} str The string to escape.
             * @returns {string} The escaped string.
             */
            function escapeHTML(str) {
                if (typeof str !== 'string') return '';
                return str.replace(/[&<>"']/g, function(match) {
                    return {
                        '&': '&amp;',
                        '<': '&lt;',
                        '>': '&gt;',
                        '"': '&quot;',
                        "'": '&#39;'
                    }[match];
                });
            }

            /**
             * Gathers checked flags into a string.
             * @returns {string} A string of flags (e.g., "gim").
             */
            function getFlags() {
                let flags = '';
                flagToggles.forEach(toggle => {
                    if (toggle.checked) {
                        flags += toggle.value;
                    }
                });
                return flags;
            }
            
            /**
             * Gathers checked flags into an object.
             * @returns {object} An object of flags (e.g., {g: true, i: true}).
             */
            function getFlagsObject() {
                const flags = {};
                flagToggles.forEach(toggle => {
                    flags[toggle.value] = toggle.checked;
                });
                return flags;
            }

            /**
             * Sets flag checkboxes based on a string.
             * @param {string} flagsString A string of flags (e.g., "gi").
             */
            function setFlags(flagsString = "") {
                const flags = new Set(flagsString.split(''));
                flagToggles.forEach(toggle => {
                    toggle.checked = flags.has(toggle.value);
                });
            }

            /**
             * Saves the current state to localStorage.
             */
            function saveState() {
                try {
                    const session = {
                        pattern: regexInput.value,
                        text: textInput.value,
                        replace: replacementInput.value,
                        flags: getFlagsObject()
                    };
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(session));
                } catch (e) {
                    console.warn("Could not save to localStorage", e);
                }
            }

            /**
             * Loads state from localStorage on page load.
             */
            function loadState() {
                try {
                    const savedSession = localStorage.getItem(STORAGE_KEY);
                    if (savedSession) {
                        const session = JSON.parse(savedSession);
                        regexInput.value = session.pattern || '';
                        textInput.value = session.text || '';
                        replacementInput.value = session.replace || '';
                        
                        if (session.flags) {
                            flagToggles.forEach(toggle => {
                                toggle.checked = session.flags[toggle.value] || false;
                            });
                        }
                    } else {
                        // Default example if no session
                        regexInput.value = '(a(p)p(l))e';
                        textInput.value = 'An apple a day. Another apple and an APPLE.';
                        document.getElementById('flag-g').checked = true;
                        document.getElementById('flag-i').checked = true;
                    }
                } catch (e) {
                    console.warn("Could not load from localStorage", e);
                    // Load default example on error
                    regexInput.value = '(a(p)p(l))e';
                    textInput.value = 'An apple a day. Another apple and an APPLE.';
                    document.getElementById('flag-g').checked = true;
                    document.getElementById('flag-i').checked = true;
                }
                
                // Trigger label animations
                [regexInput, textInput, replacementInput].forEach(el => {
                    if(el) el.dispatchEvent(new Event('input', { bubbles: true }));
                });
            }
            
            /**
             * Handles "Copy to Clipboard" functionality.
             * @param {Event} e The click event.
             */
            function handleCopyClick(e) {
                const button = e.currentTarget;
                const targetId = button.dataset.target;
                const targetElement = document.getElementById(targetId);
                
                let textToCopy = '';
                if (targetElement) {
                    textToCopy = targetElement.value !== undefined ? targetElement.value : targetElement.textContent;
                }
                
                if (targetId === 'regex-input') {
                    // Special case: format regex with flags
                    textToCopy = `/${regexInput.value}/${getFlags()}`;
                }

                navigator.clipboard.writeText(textToCopy).then(() => {
                    const originalText = button.textContent;
                    button.textContent = 'Copied!';
                    button.classList.add('copied');
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.classList.remove('copied');
                    }, 1500);
                }).catch(err => {
                    console.error('Failed to copy: ', err);
                });
            }
            
            /**
             * Handles "Clear" button functionality.
             * @param {Event} e The click event.
             */
            function handleClearClick(e) {
                const button = e.currentTarget;
                const targetId = button.dataset.target;
                const targetElement = document.getElementById(targetId);
                
                if (targetElement) {
                    targetElement.value = ''; // Clear the text
                    // Trigger 'input' event to update highlighting and results
                    targetElement.dispatchEvent(new Event('input', { bubbles: true }));
                    targetElement.focus(); // Re-focus for better UX
                }
            }

            // --- Main Function ---
            
            /**
             * Main function: validates regex, finds matches, highlights, and replaces.
             */
            function runRegexTest() {
                const pattern = regexInput.value;
                const text = textInput.value;
                const replaceString = replacementInput.value;
                const flags = getFlags();

                // Clear previous state
                errorMessage.textContent = '';
                resultOutput.textContent = 'Testing...';
                replaceOutput.textContent = '';
                highlightOutput.innerHTML = escapeHTML(text); // Default: show plain text

                if (!pattern) {
                    resultOutput.textContent = 'Enter a pattern to begin.';
                    return;
                }
                
                let regex;
                try {
                    // Create the RegExp object
                    regex = new RegExp(pattern, flags);
                } catch (error) {
                    errorMessage.textContent = `Invalid Regex: ${error.message}`;
                    resultOutput.textContent = 'Error.';
                    return;
                }

                // --- 1. Match Highlighting ---
                try {
                    // We need a global regex for highlighting all matches, even if 'g' isn't checked
                    const highlightRegex = new RegExp(pattern, flags.includes('g') ? flags : flags + 'g');
                    let parts = [];
                    let lastIndex = 0;
                    let match;
                    
                    const escapedText = escapeHTML(text);

                    while ((match = highlightRegex.exec(escapedText)) !== null) {
                        // Add text before the match
                        parts.push(escapedText.slice(lastIndex, match.index));
                        // Add the highlighted match
                        parts.push(`<mark>${match[0]}</mark>`);
                        lastIndex = highlightRegex.lastIndex;

                        // Prevent infinite loops with zero-width matches
                        if (match.index === highlightRegex.lastIndex) {
                            highlightRegex.lastIndex++;
                        }
                    }
                    // Add any remaining text after the last match
                    parts.push(escapedText.slice(lastIndex));
                    
                    highlightOutput.innerHTML = parts.join('');
                
                } catch (e) {
                    // Highlighting can fail (e.g., catastrophic backtracking)
                    // We'll just show the error and continue
                    errorMessage.textContent = `Highlighting Error: ${e.message}`;
                }


                // --- 2. Match List Output ---
                try {
                    let matches = [];
                    // Use the user-defined regex (with original flags) for the list
                    if (flags.includes('g')) {
                        if (typeof text.matchAll === 'function') {
                            matches = Array.from(text.matchAll(regex));
                        } else {
                            let match;
                            while ((match = regex.exec(text)) !== null) {
                                if (match.index === regex.lastIndex) regex.lastIndex++;
                                matches.push(match);
                            }
                        }
                    } else {
                        const match = regex.exec(text);
                        if (match) matches.push(match);
                    }

                    if (matches.length === 0) {
                        resultOutput.textContent = 'No matches found.';
                    } else {
                        let output = `Matches (${matches.length} total):\n\n`;
                        matches.forEach((match, index) => {
                            const fullMatch = JSON.stringify(match[0]);
                            const groups = match.slice(1);
                            
                            output += `Match ${index + 1} (at index ${match.index}):\n`;
                            output += `  Full: ${fullMatch}\n`;
                            
                            if (groups.length > 0) {
                                const groupStrings = groups.map(g => JSON.stringify(g === undefined ? 'undefined' : g));
                                output += `  Groups: [${groupStrings.join(', ')}]\n`;
                            }
                            output += '\n';
                        });
                        resultOutput.textContent = output;
                    }
                } catch (e) {
                    resultOutput.textContent = `Error during matching: ${e.message}`;
                }
                
                // --- 3. Replacement Output ---
                try {
                    // Use replaceAll if global, otherwise replace
                    if (flags.includes('g')) {
                        replaceOutput.textContent = text.replaceAll(regex, replaceString);
                    } else {
                        replaceOutput.textContent = text.replace(regex, replaceString);
                    }
                } catch (e) {
                    replaceOutput.textContent = `Error during replacement: ${e.message}`;
                }
                
                // --- 4. Save State ---
                saveState();
            }

            // --- File Scan Function ---
            function scanFile() {
                scanStatus.textContent = '';
                scanFileBtn.disabled = true;

                const file = fileInput.files[0];
                const pattern = regexInput.value;
                let flags = getFlags();

                if (!file) {
                    scanStatus.textContent = 'Please select a file first.';
                    scanStatus.style.color = 'var(--md-color-error)';
                    scanFileBtn.disabled = false;
                    return;
                }

                if (!pattern) {
                    scanStatus.textContent = 'Please enter a regex pattern first.';
                    scanStatus.style.color = 'var(--md-color-error)';
                    scanFileBtn.disabled = false;
                    return;
                }
                
                // Ensure the global flag is set for file scanning
                if (!flags.includes('g')) {
                    flags += 'g';
                }

                let regex;
                try {
                    regex = new RegExp(pattern, flags);
                } catch (error) {
                    scanStatus.textContent = `Invalid Regex: ${error.message}`;
                    scanStatus.style.color = 'var(--md-color-error)';
                    scanFileBtn.disabled = false;
                    return;
                }

                const reader = new FileReader();

                reader.onload = function(e) {
                    const content = e.target.result;
                    let matches = [];
                    let reportContent = 'Regex Scan Report\r\n';
                    reportContent += `Pattern: /${pattern}/${flags}\r\n`;
                    reportContent += `File: ${file.name}\r\n`;
                    reportContent += '====================================\r\n\r\n';

                    try {
                        matches = Array.from(content.matchAll(regex));
                        
                        reportContent += `Total Matches Found: ${matches.length}\r\n\r\n`;
                        
                        if (matches.length === 0) {
                            scanStatus.textContent = `Scan complete. Found 0 matches in ${file.name}.`;
                            scanStatus.style.color = 'var(--md-color-on-surface-variant)';
                            reportContent += 'No matches were found in the file.';
                        } else {
                            scanStatus.textContent = `Scan complete! Found ${matches.length} matches in ${file.name}.`;
                            scanStatus.style.color = 'var(--md-color-primary)';

                            matches.forEach((match, index) => {
                                // Add the full match
                                reportContent += `Match ${index + 1}: ${match[0]}\r\n`;
                                // Add capture groups if they exist
                                if (match.length > 1) {
                                    reportContent += `  Groups: ${JSON.stringify(match.slice(1))}\r\n`;
                                }
                            });
                        }
                        
                        // ALWAYS download the report
                        downloadReport(reportContent, `regex_report_${file.name}.txt`);

                    } catch (err) {
                        scanStatus.textContent = `Error during scan: ${err.message}`;
                        scanStatus.style.color = 'var(--md-color-error)';
                    }
                    
                    // Re-enable the button
                    scanFileBtn.disabled = false;
                    
                    // *** BUG FIX: Do NOT clear the file input. ***
                    // This allows re-scanning the same file with a new pattern.
                    // fileInput.value = ''; 
                };

                reader.onerror = function() {
                    scanStatus.textContent = 'Error reading the file.';
                    scanStatus.style.color = 'var(--md-color-error)';
                    scanFileBtn.disabled = false;
                };

                scanStatus.textContent = `Scanning ${file.name}...`;
                scanStatus.style.color = 'var(--md-color-on-surface-variant)';
                reader.readAsText(file);
            }

            /**
             * Creates and triggers a download for the report.
             * @param {string} text - The content of the report.
             * @param {string} filename - The desired name for the downloaded file.
             */
            function downloadReport(text, filename) {
                const blob = new Blob([text], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            // --- Event Listeners ---
            
            // Run test on any input change
            [regexInput, textInput, replacementInput].forEach(el => {
                if(el) el.addEventListener('input', runRegexTest);
            });
            
            flagToggles.forEach(toggle => {
                toggle.addEventListener('change', runRegexTest);
            });

            // Sync scrolling
            textInput.addEventListener('scroll', () => {
                highlightOutput.scrollTop = textInput.scrollTop;
                highlightOutput.scrollLeft = textInput.scrollLeft;
            });
            
            // Pattern Library loader
            patternLibrary.addEventListener('change', (e) => {
                const selected = e.target.options[e.target.selectedIndex];
                const pattern = selected.dataset.pattern;
                const flags = selected.dataset.flags;
                
                if (pattern) {
                    regexInput.value = pattern;
                    setFlags(flags);
                    // Manually trigger label float
                    regexInput.dispatchEvent(new Event('input', { bubbles: true }));
                    // Run the test
                    runRegexTest();
                }
            });
            
            // Copy button listeners
            copyButtons.forEach(btn => {
                btn.addEventListener('click', handleCopyClick);
            });
            
            // Clear button listeners
            clearButtons.forEach(btn => {
                btn.addEventListener('click', handleClearClick);
            });

            // --- File Scan Listener ---
            scanFileBtn.addEventListener('click', scanFile);


            // --- Initial Load ---
            loadState();
            runRegexTest(); // Run once on load with saved/default state
        });
    </script>

</body>
</html>
